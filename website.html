import React, { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { 
  X, 
  Menu as MenuIcon, 
  Instagram, 
  Facebook, 
  Twitter,
  ChevronRight,
  ShoppingBag,
  Plus
} from 'lucide-react';

const App = () => {
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const [scrolled, setScrolled] = useState(false);
  const [isOrderModalOpen, setIsOrderModalOpen] = useState(false);
  const [activeCategory, setActiveCategory] = useState('Pizza');
  
  const [orderData, setOrderData] = useState({
    name: '',
    phone: '',
    address: '',
    item: 'Cheese Pizza',
    price: '$30.00',
    quantity: '1'
  });

  const whatsappNumber = "923706181816";
  const heroImage = "https://instasize.com/p/4bec9b257ea94ef86882a949877dccbdde428329c11befdc567dcb20a9b756ce";

  useEffect(() => {
    const handleScroll = () => setScrolled(window.scrollY > 50);
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  const handleInputChange = (e) => {
    const { name, value } = e.target;
    setOrderData(prev => ({ ...prev, [name]: value }));
  };

  const openOrderModal = (item, price) => {
    setOrderData(prev => ({ ...prev, item, price }));
    setIsOrderModalOpen(true);
  };

  const sendToWhatsApp = (e) => {
    e.preventDefault();
    const message = `*NEW ORDER FROM JOE'S PIZZA*%0A%0A` +
                    `*Item:* ${orderData.item}%0A` +
                    `*Price:* ${orderData.price}%0A` +
                    `*Quantity:* ${orderData.quantity}%0A%0A` +
                    `*Customer Name:* ${orderData.name}%0A` +
                    `*Phone:* ${orderData.phone}%0A` +
                    `*Address:* ${orderData.address}%0A%0A` +
                    `_Please confirm this order ASAP!_`;
    
    window.open(`https://wa.me/${whatsappNumber}?text=${message}`, '_blank');
    setIsOrderModalOpen(false);
  };

  const JoesLogo = ({ className }) => (
    <svg viewBox="0 0 200 200" className={className} fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="100" cy="100" r="95" fill="#DC2626" />
      <circle cx="100" cy="100" r="85" stroke="white" strokeWidth="2" />
      <text x="50%" y="45%" dominantBaseline="middle" textAnchor="middle" fill="white" fontSize="40" fontWeight="900" fontFamily="serif" fontStyle="italic">JOE'S</text>
      <text x="50%" y="65%" dominantBaseline="middle" textAnchor="middle" fill="white" fontSize="28" fontWeight="900" fontFamily="serif" fontStyle="italic">PIZZA</text>
      <path d="M40 140 Q100 160 160 140" stroke="white" strokeWidth="4" fill="none" strokeLinecap="round" />
    </svg>
  );

  const menuData = {
    Pizza: [
      { name: "Cheese Pizza", price: "$30.00", desc: "Classic NY style with secret sauce.", bestSeller: true },
      { name: "Pepperoni Pizza", price: "$34.00", desc: "Our top selling pepperoni pie.", bestSeller: true },
      { name: "White with Three Toppings", price: "$40.00", desc: "Mozzarella, dollops of ricotta and 3-5 toppings." },
      { name: "Supreme Pizza", price: "$37.00", desc: "Pepperoni, sausage, mushroom and red onions." },
      { name: "Cheese Pizza with Two Toppings", price: "$36.00", bestSeller: true },
      { name: "Cheese Pizza with Three Toppings", price: "$37.00", bestSeller: true },
      { name: "Fresh Mozzarella Pizza", price: "$34.00", desc: "With fresh mozzarella.", bestSeller: true },
      { name: "Veggie Pizza", price: "$37.00", desc: "Green pepper, mushroom, red onion, broccoli, and olives." },
      { name: "Meatlovers Pizza", price: "$37.00", desc: "Pepperoni, sausage, and house made meatball." },
      { name: "Sicilian Pizza", price: "$34.00", desc: "Classic NY square pie." },
      { name: "Caprese Pizza", price: "$37.00", desc: "Fresh mozzarella, tomato, basil and olive oil." },
      { name: "Gluten Free 14\"", price: "$21.00", desc: "Safe for gluten sensitivity." }
    ],
    Salads: [
      { name: "House Salad", price: "$11.00", desc: "Iceberg lettuce, tomatoes, red onions, green peppers, black olives." },
      { name: "Family House Salad", price: "$36.00", desc: "Large portion for the whole family." }
    ],
    Beverages: [
      { name: "Soda (Canned/Plastic)", price: "$4.50", desc: "Coke, Sprite, Fanta, Diet Coke." },
      { name: "Water", price: "$3.50", desc: "Pure Life Bottled Water." },
      { name: "Glass Bottle Soda", price: "$5.50", desc: "Premium Mexican Coke/Sprite." },
      { name: "Vitamin Water", price: "$4.50", desc: "Various flavors available." }
    ]
  };

  return (
    <div className="min-h-screen bg-[#0a0a0a] text-white font-sans selection:bg-red-600 overflow-x-hidden">
      {/* Navbar */}
      <nav className={`fixed w-full z-50 transition-all duration-500 ${scrolled ? 'bg-black/95 backdrop-blur-md py-4 border-b border-white/10' : 'bg-transparent py-8'}`}>
        <div className="max-w-7xl mx-auto px-6 flex justify-between items-center">
          <div className="flex items-center gap-3">
            <JoesLogo className={scrolled ? "h-12" : "h-16"} />
            <span className="font-black italic uppercase text-2xl tracking-tighter">Joe's Pizza NYC</span>
          </div>
          <div className="hidden md:flex gap-8 items-center text-xs font-bold uppercase tracking-widest">
            <a href="#menu" className="hover:text-red-600 transition-colors">Menu</a>
            <button onClick={() => setIsOrderModalOpen(true)} className="bg-red-600 px-6 py-3 rounded-sm hover:bg-red-700 transition-all">Order Online</button>
          </div>
          <button className="md:hidden" onClick={() => setIsMenuOpen(true)}><MenuIcon size={28}/></button>
        </div>
      </nav>

      {/* Hero */}
      <section className="relative h-[80vh] flex items-center justify-center overflow-hidden">
        <div className="absolute inset-0">
          <img src={heroImage} className="w-full h-full object-cover opacity-40 scale-105" alt="Hero" />
          <div className="absolute inset-0 bg-gradient-to-t from-[#0a0a0a] to-transparent"></div>
        </div>
        <div className="relative z-10 text-center px-6">
          <motion.h1 initial={{y:30, opacity:0}} animate={{y:0, opacity:1}} className="text-7xl md:text-9xl font-black italic uppercase mb-6 tracking-tighter">The NYC <br/><span className="text-red-600">Legend</span></motion.h1>
          <p className="text-xl text-gray-400 max-w-xl mx-auto mb-8 uppercase tracking-widest">Established 1975 • Greenwich Village</p>
          <a href="#menu" className="bg-white text-black px-10 py-4 font-black uppercase tracking-widest hover:bg-red-600 hover:text-white transition-all">Explore Menu</a>
        </div>
      </section>

      {/* Menu Tabs */}
      <section id="menu" className="py-20 px-6">
        <div className="max-w-7xl mx-auto">
          <div className="flex flex-wrap gap-4 mb-16 justify-center">
            {Object.keys(menuData).map(cat => (
              <button 
                key={cat}
                onClick={() => setActiveCategory(cat)}
                className={`px-8 py-3 rounded-full font-black uppercase tracking-widest text-sm transition-all ${activeCategory === cat ? 'bg-red-600 text-white' : 'bg-zinc-900 text-gray-500 hover:text-white'}`}
              >
                {cat}
              </button>
            ))}
          </div>

          <div className="grid md:grid-cols-2 gap-6">
            <AnimatePresence mode="wait">
              {menuData[activeCategory].map((item, i) => (
                <motion.div 
                  key={item.name}
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  transition={{ delay: i * 0.05 }}
                  className="bg-zinc-900/30 border border-white/5 p-6 rounded-lg group hover:border-red-600/50 transition-all cursor-pointer relative"
                  onClick={() => openOrderModal(item.name, item.price)}
                >
                  {item.bestSeller && <span className="absolute top-4 right-4 bg-green-600 text-[10px] font-black uppercase px-2 py-1 rounded">Best Seller</span>}
                  <div className="flex justify-between items-start mb-2">
                    <h4 className="text-xl font-black italic uppercase group-hover:text-red-500 transition-colors">{item.name}</h4>
                    <span className="text-xl font-black text-red-600">{item.price}</span>
                  </div>
                  {item.desc && <p className="text-gray-500 text-sm mb-4">{item.desc}</p>}
                  <div className="flex items-center text-[10px] font-bold text-red-600 uppercase tracking-widest">
                    <Plus size={14} className="mr-1"/> Add to WhatsApp Order
                  </div>
                </motion.div>
              ))}
            </AnimatePresence>
          </div>
        </div>
      </section>

      {/* Order Modal */}
      <AnimatePresence>
        {isOrderModalOpen && (
          <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="fixed inset-0 z-[100] bg-black/95 backdrop-blur-xl flex items-center justify-center p-4 overflow-y-auto">
            <motion.div initial={{ scale: 0.9 }} animate={{ scale: 1 }} className="bg-zinc-900 w-full max-w-xl p-8 rounded-2xl border border-white/10 my-auto">
              <div className="flex justify-between items-center mb-8">
                <h3 className="text-3xl font-black italic uppercase">Confirm Order</h3>
                <button onClick={() => setIsOrderModalOpen(false)}><X/></button>
              </div>

              <form onSubmit={sendToWhatsApp} className="space-y-5">
                <div className="bg-black/50 p-4 border border-red-600/20 rounded-lg flex justify-between items-center">
                   <div>
                      <p className="text-[10px] text-gray-500 uppercase font-black">Selected Item</p>
                      <p className="text-lg font-black italic uppercase">{orderData.item}</p>
                   </div>
                   <p className="text-2xl font-black text-red-600">{orderData.price}</p>
                </div>

                <div className="grid md:grid-cols-2 gap-4">
                  <div className="space-y-2">
                    <label className="text-[10px] uppercase font-black text-gray-500">Your Name</label>
                    <input required name="name" onChange={handleInputChange} className="w-full bg-black border border-white/10 p-4 rounded focus:border-red-600 outline-none transition-all" />
                  </div>
                  <div className="space-y-2">
                    <label className="text-[10px] uppercase font-black text-gray-500">Quantity</label>
                    <select name="quantity" onChange={handleInputChange} className="w-full bg-black border border-white/10 p-4 rounded focus:border-red-600 outline-none transition-all">
                      {[1,2,3,4,5,10].map(n => <option key={n} value={n}>{n} Order(s)</option>)}
                    </select>
                  </div>
                </div>

                <div className="space-y-2">
                  <label className="text-[10px] uppercase font-black text-gray-500">Phone (WhatsApp)</label>
                  <input required name="phone" placeholder="03xx xxxxxxx" onChange={handleInputChange} className="w-full bg-black border border-white/10 p-4 rounded focus:border-red-600 outline-none transition-all" />
                </div>

                <div className="space-y-2">
                  <label className="text-[10px] uppercase font-black text-gray-500">Full Delivery Address</label>
                  <textarea required name="address" onChange={handleInputChange} className="w-full bg-black border border-white/10 p-4 rounded focus:border-red-600 outline-none transition-all h-24" />
                </div>

                <button type="submit" className="w-full bg-red-600 py-5 rounded-lg font-black uppercase tracking-widest text-lg hover:bg-red-700 transition-all flex items-center justify-center gap-4 shadow-[0_0_30px_rgba(220,38,38,0.3)]">
                   <ShoppingBag size={24}/> SEND ORDER TO WHATSAPP
                </button>
              </form>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>

      <footer className="bg-black py-20 border-t border-white/5 text-center px-6">
        <JoesLogo className="h-20 mx-auto mb-6" />
        <h4 className="text-2xl font-black italic uppercase mb-2">Joe's Pizza NYC</h4>
        <p className="text-gray-600 text-xs uppercase tracking-[0.5em] mb-10">Legendary Taste • 0370 6181816</p>
        <div className="flex justify-center gap-6 text-gray-500">
           <Instagram size={24} className="hover:text-red-600 cursor-pointer"/>
           <Facebook size={24} className="hover:text-red-600 cursor-pointer"/>
           <Twitter size={24} className="hover:text-red-600 cursor-pointer"/>
        </div>
      </footer>
    </div>
  );
};

export default App;